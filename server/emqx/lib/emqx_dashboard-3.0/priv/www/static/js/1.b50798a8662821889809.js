webpackJsonp([1],{g8ks:function(e,r,o){"use strict";var s=o("Dd8w"),t=o.n(s),l={name:"emq-resource-dialog",props:{visible:{type:Boolean,required:!0}},data:function(){var e={required:!0,message:"请输入"},r={type:"number",min:1,max:65536,message:"1~65536"};return{loading:!1,title:"资源",resourceID:"",step:1,list:[{icon:"fa-expand",name:"Kafka",type:"kafka",description:""},{icon:"fa-database",name:"PostgreSQL",type:"pgsql",description:""},{icon:"fa-database",name:"MySQL",type:"mysql",description:""},{icon:"fa-floppy-o",name:"Redis",type:"redis",description:""},{icon:"fa-database",name:"MongoDB",type:"mongo",description:""},{icon:"fa-toggle-off",name:"WebHook",type:"http",description:""}],record:{type:"",kafka:{servers:"127.0.0.1:9092",produce:"sync",max_buffer_size:1e4,max_buffer_ttl:"1s",per_partition_workers:64},pgsql:{server:"127.0.0.1:5432",user:"root",password:"root",database:"platform",encoding:"utf8",pool:8,ssl:!1,keyfile:"",certfile:""},webhook:{server:" http://127.0.0.1:9099/rules"},mysql:{server:"127.0.0.1:3306",user:"root",password:"root",database:"platform",encoding:"utf8",pool:8,ssl:!1,keyfile:"",certfile:""},mongo:{server:"127.0.0.1:27017",pool:8,database:"platform",login:"",password:"",ssl:!1,keyfile:"",certfile:""},redis:{server:"127.0.0.1:6379",pool:8,database:0,password:"",sentinel:""}},recordStash:{},operator:"create",operatorDict:{create:"初始化配置",edit:"编辑资源",view:"资源详情"},rules:{type:{required:!0,message:"请选择"},name:e,kafka:{servers:e,produce:{required:!0,message:"请选择"},max_buffer_size:r},pgsql:{server:e,user:e,database:e,pool:r,keyfile:e,certfile:e},mysql:{server:e,user:e,database:e,pool:r,keyfile:e,certfile:e},mongo:{server:e,database:e,pool:r,keyfile:e,certfile:e},redis:{server:e,pool:r,database:e},webhook:{server:e}}}},methods:{handleNext:function(e){var r=e.type;r&&(this.record.type=r,this.step=2)},handlePreConnect:function(){var e=this;this.$refs.record.validate(function(r){if(r){var o=t()({},e.record[e.record.type]);o.name=e.record.name,o.description=e.record.description,o.type=e.record.type,e.$httpPut("/resource/status",o).then(function(){e.$message.success("资源可以成功连接！")}).catch(function(){})}})},handleLast:function(){this.step=1},close:function(){this.$emit("update:visible",!1)},handleOpen:function(){if("create"===this.operator)return this.record=t()({},this.recordStash),void(this.step=1);this.loadData()},handleClose:function(){this.record.type="",this.step=1,this.$emit("close"),this.close()},handleConfirm:function(){var e=this;this.$refs.record.validate(function(r){if(r){var o=t()({},e.record[e.record.type]);o.name=e.record.name,o.description=e.record.description,o.type=e.record.type,"edit"===e.operator?e.$httpPut("/resource/"+e.resourceID,o).then(function(){e.$message.success("编辑成功"),e.$emit("confirm",o),e.handleClose()}):"create"===e.operator?e.$httpPost("/resource/"+e.resourceID,o).then(function(){e.$message.success("新建成功"),e.$emit("confirm",o),e.handleClose()}):(e.$emit("confirm",o),e.handleClose())}})},loadData:function(){var e=this;["view","edit"].includes(this.operator)&&this.resourceID&&(this.step=2,this.loading=!0,this.$httpGet("/resource/"+this.resourceID).then(function(r){e.record[e.record.type]=r.data,e.loading=!1}).catch(function(){e.loading=!1}))}},created:function(){this.recordStash=t()({},this.record)},computed:{disabled:function(){return"view"===this.operator}}},a={render:function(){var e=this,r=e.$createElement,o=e._self._c||r;return o("el-dialog",{staticClass:"emq-resource-dialog",attrs:{width:"500px",title:1===e.step?"选择资源类型":e.operatorDict[e.operator],visible:e.visible},on:{open:e.handleOpen,close:e.handleClose}},[1===e.step?o("el-row",{staticClass:"card-list",staticStyle:{"margin-top":"18px"},attrs:{gutter:20}},e._l(e.list,function(r,s){return o("el-col",{key:s,attrs:{span:12}},[o("div",{staticClass:"item-card btn",class:{active:e.record.type===r.type},on:{click:function(o){e.handleNext(r)}}},[o("i",{staticClass:"fa card-icon",class:r.icon}),e._v(" "),o("h4",[e._v(e._s(r.name))])])])})):o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"record",attrs:{model:e.record,rules:e.disabled?{}:e.rules,disabled:e.disabled}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"name",label:"资源名称"}},[o("el-input",{model:{value:e.record.name,callback:function(r){e.$set(e.record,"name",r)},expression:"record.name"}})],1)],1),e._v(" "),"kafka"===e.record.type?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"kafka.servers",label:"连接地址"}},[o("el-input",{attrs:{placeholder:"servers"},model:{value:e.record.kafka.servers,callback:function(r){e.$set(e.record.kafka,"servers",r)},expression:"record.kafka.servers"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"kafka.produce",label:"Produce"}},[o("emq-select",{attrs:{field:{key:"kafkaProduce"},record:e.record},model:{value:e.record.kafka.produce,callback:function(r){e.$set(e.record.kafka,"produce",r)},expression:"record.kafka.produce"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"kafka.max_buffer_size",label:"Max Buffer Size"}},[o("el-input",{attrs:{type:"number",placeholder:"max_buffer_size:10000"},model:{value:e.record.kafka.max_buffer_size,callback:function(r){e.$set(e.record.kafka,"max_buffer_size",e._n(r))},expression:"record.kafka.max_buffer_size"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"kafka.max_buffer_ttl",label:"Max Buffer TTL"}},[o("el-input",{attrs:{placeholder:"max_buffer_ttl:1s"},model:{value:e.record.kafka.max_buffer_ttl,callback:function(r){e.$set(e.record.kafka,"max_buffer_ttl",r)},expression:"record.kafka.max_buffer_ttl"}})],1)],1)],1):e._e(),e._v(" "),"pgsql"===e.record.type?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"pgsql.server",label:"连接地址"}},[o("el-input",{model:{value:e.record.pgsql.server,callback:function(r){e.$set(e.record.pgsql,"server",r)},expression:"record.pgsql.server"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"pgsql.database",label:"数据库"}},[o("el-input",{attrs:{placeholder:"database:platform"},model:{value:e.record.pgsql.database,callback:function(r){e.$set(e.record.pgsql,"database",r)},expression:"record.pgsql.database"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"pgsql.user",label:"数据库用户名"}},[o("el-input",{attrs:{placeholder:"user:root"},model:{value:e.record.pgsql.user,callback:function(r){e.$set(e.record.pgsql,"user",r)},expression:"record.pgsql.user"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"pgsql.password",label:"数据库密码"}},[o("el-input",{attrs:{placeholder:"password:root"},model:{value:e.record.pgsql.password,callback:function(r){e.$set(e.record.pgsql,"password",r)},expression:"record.pgsql.password"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"pgsql.pool",label:"连接池大小"}},[o("el-input",{attrs:{type:"number",placeholder:"pool:8"},model:{value:e.record.pgsql.pool,callback:function(r){e.$set(e.record.pgsql,"pool",e._n(r))},expression:"record.pgsql.pool"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"pgsql.ssl",label:"SSL 连接"}},[o("emq-select",{attrs:{record:e.record,field:{key:"booleanType"}},model:{value:e.record.pgsql.ssl,callback:function(r){e.$set(e.record.pgsql,"ssl",r)},expression:"record.pgsql.ssl"}})],1)],1),e._v(" "),e.record.pgsql.ssl?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"pgsql.keyfile",label:"keyfile"}},[o("el-input",{model:{value:e.record.pgsql.keyfile,callback:function(r){e.$set(e.record.pgsql,"keyfile",r)},expression:"record.pgsql.keyfile"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"pgsql.certfile",label:"certfile"}},[o("el-input",{model:{value:e.record.pgsql.certfile,callback:function(r){e.$set(e.record.pgsql,"certfile",r)},expression:"record.pgsql.certfile"}})],1)],1)],1):e._e()],1):e._e(),e._v(" "),"webhook"===e.record.type?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"webhook.server",label:"连接地址"}},[o("el-input",{model:{value:e.record.webhook.server,callback:function(r){e.$set(e.record.webhook,"server",r)},expression:"record.webhook.server"}})],1)],1)],1):e._e(),e._v(" "),"mysql"===e.record.type?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mysql.server",label:"连接地址"}},[o("el-input",{model:{value:e.record.mysql.server,callback:function(r){e.$set(e.record.mysql,"server",r)},expression:"record.mysql.server"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mysql.database",label:"数据库"}},[o("el-input",{attrs:{placeholder:"database:platform"},model:{value:e.record.mysql.database,callback:function(r){e.$set(e.record.mysql,"database",r)},expression:"record.mysql.database"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mysql.user",label:"数据库用户名"}},[o("el-input",{attrs:{placeholder:"user:root"},model:{value:e.record.mysql.user,callback:function(r){e.$set(e.record.mysql,"user",r)},expression:"record.mysql.user"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mysql.password",label:"数据库密码"}},[o("el-input",{attrs:{placeholder:"password:root"},model:{value:e.record.mysql.password,callback:function(r){e.$set(e.record.mysql,"password",r)},expression:"record.mysql.password"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mysql.pool",label:"连接池大小"}},[o("el-input",{attrs:{type:"number",placeholder:"pool:8"},model:{value:e.record.mysql.pool,callback:function(r){e.$set(e.record.mysql,"pool",e._n(r))},expression:"record.mysql.pool"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mysql.ssl",label:"SSL 连接"}},[o("emq-select",{attrs:{record:e.record,field:{key:"booleanType"}},model:{value:e.record.mysql.ssl,callback:function(r){e.$set(e.record.mysql,"ssl",r)},expression:"record.mysql.ssl"}})],1)],1),e._v(" "),e.record.mysql.ssl?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mysql.keyfile",label:"keyfile"}},[o("el-input",{model:{value:e.record.mysql.keyfile,callback:function(r){e.$set(e.record.mysql,"keyfile",r)},expression:"record.mysql.keyfile"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mysql.certfile",label:"certfile"}},[o("el-input",{model:{value:e.record.mysql.certfile,callback:function(r){e.$set(e.record.mysql,"certfile",r)},expression:"record.mysql.certfile"}})],1)],1)],1):e._e()],1):e._e(),e._v(" "),"mongo"===e.record.type?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mongo.server",label:"连接地址"}},[o("el-input",{model:{value:e.record.mongo.server,callback:function(r){e.$set(e.record.mongo,"server",r)},expression:"record.mongo.server"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mongo.database",label:"数据库"}},[o("el-input",{attrs:{placeholder:"database:platform"},model:{value:e.record.mongo.database,callback:function(r){e.$set(e.record.mongo,"database",r)},expression:"record.mongo.database"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mongo.login",label:"数据库用户名"}},[o("el-input",{model:{value:e.record.mongo.login,callback:function(r){e.$set(e.record.mongo,"login",r)},expression:"record.mongo.login"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mongo.password",label:"数据库密码"}},[o("el-input",{model:{value:e.record.mongo.password,callback:function(r){e.$set(e.record.mongo,"password",r)},expression:"record.mongo.password"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mongo.pool",label:"连接池大小"}},[o("el-input",{attrs:{type:"number",placeholder:"pool:8"},model:{value:e.record.mongo.pool,callback:function(r){e.$set(e.record.mongo,"pool",e._n(r))},expression:"record.mongo.pool"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mongo.ssl",label:"SSL 连接"}},[o("emq-select",{attrs:{record:e.record,field:{key:"booleanType"}},model:{value:e.record.mongo.ssl,callback:function(r){e.$set(e.record.mongo,"ssl",r)},expression:"record.mongo.ssl"}})],1)],1),e._v(" "),e.record.mongo.ssl?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mongo.keyfile",label:"keyfile"}},[o("el-input",{model:{value:e.record.mongo.keyfile,callback:function(r){e.$set(e.record.mongo,"keyfile",r)},expression:"record.mongo.keyfile"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"mongo.certfile",label:"certfile"}},[o("el-input",{model:{value:e.record.mongo.certfile,callback:function(r){e.$set(e.record.mongo,"certfile",r)},expression:"record.mongo.certfile"}})],1)],1)],1):e._e()],1):e._e(),e._v(" "),"redis"===e.record.type?o("div",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"redis.server",label:"连接地址"}},[o("el-input",{model:{value:e.record.redis.server,callback:function(r){e.$set(e.record.redis,"server",r)},expression:"record.redis.server"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"redis.database",label:"数据库"}},[o("emq-select",{attrs:{record:e.record,field:{key:"redisDatabase"},placeholder:"database:0"},model:{value:e.record.redis.database,callback:function(r){e.$set(e.record.redis,"database",e._n(r))},expression:"record.redis.database"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"redis.password",label:"数据库密码"}},[o("el-input",{model:{value:e.record.redis.password,callback:function(r){e.$set(e.record.redis,"password",r)},expression:"record.redis.password"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"redis.pool",label:"连接池大小"}},[o("el-input",{attrs:{type:"number",placeholder:"pool:8"},model:{value:e.record.redis.pool,callback:function(r){e.$set(e.record.redis,"pool",e._n(r))},expression:"record.redis.pool"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"redis.sentinel",label:"Sentinel"}},[o("el-input",{model:{value:e.record.redis.sentinel,callback:function(r){e.$set(e.record.redis,"sentinel",r)},expression:"record.redis.sentinel"}})],1)],1)],1):e._e(),e._v(" "),"rabbitmq"===e.record.type?o("div"):e._e(),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{model:{value:e.record.description,callback:function(r){e.$set(e.record,"description",r)},expression:"record.description"}})],1)],1)],1)],1),e._v(" "),o("div",{staticClass:"operation-area",attrs:{slot:"footer"},slot:"footer"},[2!==e.step||e.disabled?e._e():o("div",["edit"!==e.operator?o("el-button",{staticStyle:{float:"left"},attrs:{type:"text",icon:"el-icon-arrow-left"},on:{click:e.handleLast}},[e._v("上一步")]):e._e(),e._v(" "),"edit"!==e.operator?o("el-button",{attrs:{type:"text"},on:{click:e.handlePreConnect}},[e._v("测试连接")]):e._e(),e._v(" "),o("el-button",{attrs:{type:"text"},on:{click:e.close}},[e._v("取消")]),e._v(" "),2!==e.step||e.disabled?e._e():o("el-button",{attrs:{type:"success"},on:{click:e.handleConfirm}},[e._v("确定")])],1)])],1)},staticRenderFns:[]};var c=o("VU/8")(l,a,!1,function(e){o("hGLX")},null,null);r.a=c.exports},hGLX:function(e,r){}});