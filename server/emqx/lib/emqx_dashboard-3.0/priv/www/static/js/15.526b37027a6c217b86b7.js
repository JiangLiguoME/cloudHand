webpackJsonp([15],{"Oo+r":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"emq-rule",components:{EmqResourceDialog:n("g8ks").a},data:function(){return{dialogVisible:!1,list:[],typeIcon:{mysql:"fa-database",pgsql:"fa-database",kafka:"fa-expand",rabbitmq:"fa-expand",webhook:"fa-toggle-off",mongodb:"fa-database",redis:"fa-database"},typeName:{kafka:"Kafka",pgsql:"PostgresSQL",webhook:"WebHook",mysql:"MySQL",mongodb:"MongoDB",redis:"Redis",rabbitmq:"RabbitMQ"}}},methods:{loadData:function(){},handleCommand:function(t){var e=this,n=t.command,a=void 0===n?"create":n,s=t.item,i=void 0===s?{}:s;console.log("command",a),"create"===a?this.$router.push("/rule/0?oper=create"):"edit"===a?this.$router.push("/rule/"+i.id+"?oper=edit"):"start"===a?this.$httpPut("/rule/"+i.id+"/"+(i.running?"load":"unload")).then(function(){e.$message.success("操作成功"),e.loadData()}):"delete"===a?this.$confirm("此操作将停用并删除该规则, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$httpDelete("/rule/"+i.id).then(function(){e.$message.success("删除成功"),e.loadData()})}).catch(function(){}):"view"===a&&this.$router.push("/rule/"+i.id+"?oper=view")},handleResourceView:function(t){var e=this.$refs.resourceDialog;e.resourceID=t.id,e.operator="view",this.dialogVisible=!0,console.log(t)}},created:function(){this.loadData()}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"emq-rule"},[n("div",{staticClass:"page-title"},[t._v("\n    消息规则\n\n    "),n("el-button",{staticClass:"confirm-btn",staticStyle:{float:"right"},attrs:{round:"",plain:"",type:"success",icon:"el-icon-plus",disable:t.$store.state.loading},on:{click:t.handleCommand}},[t._v("\n      新建\n    ")])],1),t._v(" "),n("el-row",{staticClass:"emq-rule-list cards-lit",attrs:{gutter:40}},[t.list.length>0?n("div",t._l(6,function(e,a){return n("el-col",{key:a,attrs:{xs:12,sm:8}},[n("el-card",{staticClass:"list-card el-card--self btn",attrs:{shadow:"hover"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[t._v("\n            "+t._s(e.name||"规则名称")+"\n          ")]),t._v(" "),n("el-dropdown",{attrs:{placement:"bottom"},on:{command:t.handleCommand}},[n("i",{staticClass:"el-icon-more"}),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:{command:"edit",item:e}}},[t._v("编辑")]),t._v(" "),n("el-dropdown-item",{attrs:{command:{command:"start",item:e}}},[t._v("\n                  "+t._s(e.running?"禁用":"启用")+"\n                ")]),t._v(" "),n("el-dropdown-item",{attrs:{command:{command:"delete",item:e}}},[t._v("删除")])],1)],1)],1),t._v(" "),n("div",{staticClass:"item btn",on:{click:[function(t){t.stopPropagation()},function(n){t.handleCommand({command:"view",item:e})}]}},[n("ul",[n("li",[t._v("\n                使用资源：\n                "),n("i",{staticClass:"status btn a-line",class:{running:e.running},on:{click:[function(t){t.stopPropagation()},function(n){if(n.target!==n.currentTarget)return null;t.handleResourceView(e)}]}},[t._v("\n                  "+t._s(e.server||"qingcloud-kafka-3core")+"\n                  "),n("span",{directives:[{name:"show",rawName:"v-show",value:!e.running,expression:"!item.running"}],on:{click:function(n){if(n.target!==n.currentTarget)return null;t.handleResourceView(e)}}},[t._v("(已停止)")])])]),t._v(" "),n("li",[t._v("\n                适用主题：\n                "+t._s(e.topic||"#")+"\n              ")]),t._v(" "),n("li",[t._v("\n                适用 QoS：\n                "+t._s(e.qos||"任意 QoS")+"\n              ")]),t._v(" "),n("li",[t._v("\n                启用时间：\n                "+t._s(e.createAt||"3h 44 min")+"\n              ")]),t._v(" "),n("li",[t._v("\n                状态：\n                "),n("el-tag",{staticStyle:{"margin-right":"8px"},attrs:{type:"success",plain:"",size:"mini"}},[t._v(t._s(e.number||"20")+" 成功")]),t._v(" "),n("el-tag",{attrs:{type:"danger",plain:"",size:"mini"}},[t._v(t._s(e.number||1)+" 失败")])],1),t._v(" "),n("li",[t._v("\n                备注：\n                "+t._s(e.description||"全部消息")+"\n              ")])])])])],1)})):n("div",{staticClass:"blank"},[n("div",{staticClass:"icon"},[n("i",{staticClass:"fa fa-random"})]),t._v(" "),n("h2",[t._v("消息规则")]),t._v(" "),n("p",[t._v("配置 EMQ 设备消息持久化规则。")]),t._v(" "),n("el-button",{attrs:{type:"success"},on:{click:function(e){t.list.push(1)}}},[t._v("新建规则")])],1)]),t._v(" "),n("emq-resource-dialog",{ref:"resourceDialog",attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}})],1)},staticRenderFns:[]};var i=n("VU/8")(a,s,!1,function(t){n("j/Gj")},null,null);e.default=i.exports},"j/Gj":function(t,e){}});